# ヒーロー画像カスタマイザー実装ガイド

## 概要

WordPress カスタマイザーでトップページのヒーロー画像を最大 5 枚まで設定できる機能を実装しました。

## 実装内容

### 1. functions.php に追加された機能

#### カスタマイザー設定関数

```php
sr_customize_register($wp_customize)
```

- **目的**: ヒーロー画像設定用のカスタマイザーセクションを追加
- **機能**: 最大 5 枚の画像をメディアライブラリから選択可能

#### ヒーロー画像取得関数

```php
get_sr_hero_images()
```

- **目的**: 設定された画像を取得し、デフォルト画像のフォールバック機能を提供
- **戻り値**: 画像 URL・alt テキストの配列

### 2. カスタマイザーでの設定方法

#### 管理画面での操作手順

1. **WordPress 管理画面** → **外観** → **カスタマイズ**
2. **「ヒーロー画像設定」**セクションを開く
3. **「ヒーロー画像 1」～「ヒーロー画像 5」**で画像を選択
4. **「公開」**ボタンで設定を保存

#### 設定可能な画像形式

- JPEG (.jpg, .jpeg)
- PNG (.png)
- WebP (.webp)
- GIF (.gif)

### 3. 動作仕様

#### デフォルト動作

- 画像が設定されていない場合は既存のデフォルト画像を表示
  - `images/keyvisual_01.jpg`
  - `images/keyvisual_02.jpg`

#### 設定後の動作

- 設定された画像のみをスライダーで表示
- 1 枚でも設定すればデフォルト画像は表示されない
- 画像の順番は設定順（ヒーロー画像 1→2→3...）

#### alt テキスト処理

- メディアライブラリで設定された alt テキストを自動取得
- alt テキストがない場合は「ヒーロー画像{番号}」を自動設定

### 4. front-page.php の変更点

#### 変更前（固定画像）

```php
<div class="swiper-slide">
    <img src=".../keyvisual_01.jpg" alt="..." />
</div>
```

#### 変更後（動的画像）

```php
<?php
$hero_images = get_sr_hero_images();
foreach ($hero_images as $image_data) :
?>
    <div class="swiper-slide">
        <img src="<?php echo esc_url($image_data['url']); ?>"
             alt="<?php echo esc_attr($image_data['alt']); ?>" />
    </div>
<?php endforeach; ?>
```

### 5. 推奨画像サイズ

#### 最適なサイズ

- **幅**: 1920px 以上
- **高さ**: 1080px 以上
- **アスペクト比**: 16:9 または 3:2
- **ファイルサイズ**: 500KB 以下推奨

#### レスポンシブ対応

- 画像は自動的にコンテナサイズに合わせて調整
- `object-fit: cover`でトリミング表示

### 6. カスタマイズ方法

#### デフォルト画像の変更

`get_sr_hero_images()`関数内の`$default_images`配列を編集：

```php
$default_images = array(
    get_stylesheet_directory_uri() . '/images/新しい画像1.jpg',
    get_stylesheet_directory_uri() . '/images/新しい画像2.jpg',
);
```

#### 最大画像数の変更

functions.php の`for ($i = 1; $i <= 5; $i++)`の`5`を変更

#### カスタマイザーセクション名の変更

```php
$wp_customize->add_section('sr_hero_images', array(
    'title' => '新しいセクション名',
    'description' => '新しい説明文',
));
```

### 7. トラブルシューティング

#### 画像が表示されない場合

1. メディアライブラリに画像が正しくアップロードされているか確認
2. 画像のファイル権限が適切か確認（644 推奨）
3. カスタマイザーで「公開」ボタンを押したか確認

#### スライダーが動作しない場合

1. Swiper ライブラリが正しく読み込まれているか確認
2. JavaScript エラーがないかブラウザコンソールで確認

#### パフォーマンス最適化

1. 画像を適切なサイズに圧縮
2. WebP 形式の使用を検討
3. 遅延読み込み（lazy loading）の実装

### 8. セキュリティ対策

#### 実装済みの対策

- `esc_url()`による URL サニタイズ
- `esc_attr()`による属性値サニタイズ
- `absint()`による数値サニタイズ
- メディアライブラリ経由の画像のみ許可

## 使用方法まとめ

1. 管理画面の**カスタマイザー**を開く
2. **「ヒーロー画像設定」**で最大 5 枚の画像を設定
3. 設定を**公開**して完了
4. 画像未設定時は自動的にデフォルト画像を表示
